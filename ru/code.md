# code

Методы модели **code** используются для предоставления мерчанту возможностей приема и выплат средств через кодовые платежные обязательства. Используя методы модели **code** мерчант может:

1. Создать код платежа - метод [code.create](code.md#code_create)
2. Проверить \(верифицировать\) код платежа - метод [code.verify](code.md#code_verify)
3. Использовать \(акцептовать\) код платежа - метод [code.redeem](code.md#code_redeem)
4. Получить информацию о коде, использованном для платежа - метод [code.get](code.md#code_get)

## endpoint

Запросы на работу методов модели отправляются на endpoint **`https://api.any.money/`**.

## code.create

Метод создания кода заданной чековой платежной системы, в котором учитываются сумма и валюта платежа.

??? abstract "Входящие параметры метода"

| param | required | example | description |
| ---: | :---: | :--- | :--- |
| amount | yes | "655" | сумма выплаты \(сумма, фиксированная в коде, а не снимаемая с баланса мерчанта\) |
| curr | yes | "UAH" | название валюты, в которой заказан платежный код |
| externalid | yes | "235" | уникальный идентификатор, заданный мерчантом |
| payway | yes | "anycash" | платежная система, через которую проводится выплата |

!!! warning "Внимание!" Для типизированных мерчантов значение **payway** должно совпадать с типом мерчанта, иначе возвратится ошибка

!!! warning "Внимание!" Сразу после поступления запроса вызывается его обработка, а после выполнения метода **деньги будут списаны с баланса**

!!! success "Данные ответа метода" **code**сгенерированный код

??? failure "Возможные возвращаемые ошибки" **EParamAmountFormatInvalid**неверное значение или формат параметра \*\*amount\*\***EParamAmountTooBig**\*\*amount\*\* больше максимальной суммы операции**EParamAmountTooSmall**\*\*amount\*\* меньше минимальной суммы операции**EParamCurrencyInvalid**передана несуществующая входящая и/или исходящая валюта, валюта запрещена для использования данным мерчантом в указанной платёжной системе**EParamInvalid**

## code.verify

Метод получения данных кода входящей оплаты по его полному номеру.

??? abstract "Входящие параметры метода"

| param | required | example | description |
| ---: | :---: | :--- | :--- |
| code | yes | "3453464745t8t8" | полный номер искомого кода |

!!! success "Данные ответа метода" Репрезентация данных платежного кода **amount**сумма непогашенного кода \(для кода ПС "EXMO" поле будет пустым\)**can\_be\_accepted**возможно ли погашение кода \(возможные значения: "yes", "no" или "unknown"\)**currency**наименование валюты платежа**fee**репрезентация комиссии погашения кода**add** - фиксированная сумма комиссии**max** - максимальная сумма комиссии**min** - минимальная сумма комиссии**mult** - процентная ставка комиссии**method** - метод взимания комиссии&lt;/dd&gt; **fee\_value** значение комиссии в валюте кодового платежа, если в ответе ПС указана сумма платежа. Иначе значение параметра равно "unknown" **payway** наименование кодовой платежной системы &lt;/dl&gt;

??? failure "Возможные возвращаемые ошибки" **EParamInvalid**не передан параметр \*\*code\*\*, передано неверное значение параметра \*\*code\*\***EParamCodeInvalid**

## code.redeem

Метод обналичивание кодового платежа путем создания ордера пополнения кодом.

??? abstract "Входящие параметры метода"

| param | required | example | description |
| ---: | :---: | :--- | :--- |
| code | yes | "3453464745t8t8" | полный номер кода внешней ПС |
| externalid | yes | "123" | уникальный идентификатор, заданный мерчантом |

!!! success "Данные ответа метода" [Репрезентация ордера погашения кода](add_order.md)&lt;/dd&gt;

??? failure "Возможные возвращаемые ошибки" **EParamAmountTooBig** сумма кодового платежа больше максимальной суммы конвертации**EParamAmountTooSmall** сумма кодового платежа меньше минимальной суммы операции**EParamCodeInvalid** код не может быть принят системой**EParamCurrencyInvalid** код создан в валюте, недоступной в Any.Money**EParamInvalid** не передан параметр \*\*externalid\*\***EParamPaywayInvalid** код не может быть погашен ни в одной из доступных ПС**EParamType** передан параметр \*\*externalid\*\* неподходящего формата**EStatePaywayInactive**

## code.get

Метод получения информации о коде по переданному идентификатору ордера \(**externalid**\).

??? abstract "Входящие параметры метода"

| param | required | example | description |
| ---: | :---: | :--- | :--- |
| externalid | yes | "123" | идентификатор ордера в системе магазина |

!!! success "Данные ответа метода" **amount**сумма платежа**code**сгенерированный код**currency**валюта платежа

??? failure "Возможные возвращаемые ошибки" **EParamInvalid**недопустимое значение \*\*externalid\*\***EParamNotFound**не найден ордер c переданным \*\*externalid\*\***EParamType**невалидный тип данных \*\*externalid\*\***EStateUnavailable**невозможно получить информацию от внешней системы

