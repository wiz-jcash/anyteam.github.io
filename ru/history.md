# history

Используя методы модели **history** мерчант может получить:

1. Историю поступивших выставленных счетов - метод [history.invoice](history.md#history_invoice)
2. Историю созданных ордеров на оплату - метод [history.code](history.md#history_code)
3. Историю созданных ордеров на выплату - метод [history.payout](history.md#history_payout)
4. Историю созданных ордеров конвертации валют - метод [history.convert](history.md#history_convert)
5. Историю созданных ордеров перевода средств - метод [history.transfer](history.md#history_transfer)
6. Историю операций мерчанта - метод [history.statement](history.md#history_statement)
7. Историю криптоадресов мерчанта - метод [history.address](history.md#history_address)

## endpoint

Запросы на работу методов модели отправляются на endpoint **`https://api.any.money/`**.

## history.invoice

Метод отображения списка ордеров типа **invoice** и **payin**, созданных мерчантом \(одноплатёжное или мультиплатёжное пополнение любыми валютами\).  
Результат возвращается в виде отсортированного по убыванию даты создания перечня ордеров типа **invoice**. Для каждого из них доступна репрезентация параметров.

??? abstract "Входящие параметры метода"

| param | required | description |
| ---: | :---: | :--- |
| count | no | размер выборки ответов метода \(значение не может превышать "200"\). default="20" |
| first | no | номер первого объекта в выборке результатов, с которого начнется их репрезентация и отсчёт параметра **count**. default="0" |
| in\_curr | no | фильтр ордеров по валюте пополнения |
| out\_curr | no | фильтр ордеров по валюте зачисления |
| payway | no | фильтр платежной системы, из которой поступил платеж |

!!! success "Данные ответа метода" **count**размер текущей выборки ответов**data**массив \[репрезентаций ордеров\]\(add\_order.md\) типа \*\*invoice\*\***first**номер первого ордера в выборке ответов метода**page**текущая страница ответов**page\_total**всего страниц ответов**total**всего найдено ордеров, соответствующих фильтрам запроса

??? failure "Возможные возвращаемые ошибки" **EParamCurrencyInvalid**не удалось найти валюту с переданным именем \*\*in\_curr\*\*, \*\*out\_curr\*\***EParamInvalid**передано неверное значение параметра**EParamPaywayInvalid**указана неверная платежная система**EParamType**параметр содержит некорректный тип данных

## history.code

Метод отображения списка ордеров, пополняемых кодовыми \(чековыми\) платежами, привязанных к данному мерчанту. Фильтры поиска объединены логическим **И**.  
Результат возвращается в виде отсортированного по убыванию даты создания перечня ордеров типа **coderedeem** c репрезентациями их параметров.

??? abstract "Входящие параметры метода"

| param | required | example | description |
| ---: | :---: | :--- | :--- |
| count | no | "100" | размер выборки ответов метода \(значение не может превышать "200"\). default="20" |
| first | no | "25" | номер первого объекта в выборке результатов, с которого начнется их репрезентация и отсчёт параметра **count**. default="0" |
| in\_curr | no | "UAH" | фильтр ордеров по валюте пополнения |
| out\_curr | no | "GBP" | фильтр ордеров по валюте зачисления |
| payway | no | "anycash" | фильтр платежной системы, из которой поступил платеж |

!!! success "Данные ответа метода" **count**размер текущей выборки ответов**data**массив \[репрезентаций ордеров\]\(add\_order.md\) типа \*\*invoice\*\***first**номер первого ордера в выборке ответов метода**page**текущая страница ответов**page\_total**всего страниц ответов**total**всего найдено ордеров, соответствующих фильтрам запроса

??? failure "Возможные возвращаемые ошибки" **EParamCurrencyInvalid**не удалось найти валюту с переданным именем \*\*in\_curr\*\*, \*\*out\_curr\*\***EParamInvalid**передано неверное значение параметра**EParamPaywayInvalid**указана неверная платежная система**EParamType**параметр содержит некорректный тип данных

## history.payout

Метод отображения перечня ордеров выплат, привязанных к данному мерчанту. Фильтры поиска объединены логическим **И**.  
Результат возвращается в виде отсортированного по убыванию даты создания перечня ордеров типа **payout**. Для каждого из них доступна репрезентация его параметров.

??? abstract "Входящие параметры метода"

| param | required | example | description |
| ---: | :---: | :--- | :--- |
| count | no | "38" | размер выборки ответов метода \(значение не может превышать "200"\). default="20" |
| first | no | "10" | номер первого объекта в выборке результатов, с которого начнется их репрезентация и отсчёт параметра **count**. default="0" |
| in\_curr | no | "UAH" | валюта пополнения. Баланс мерчанта, из которого совершен платеж |
| out\_curr | no | "USD" | валюта, в которой заказана выплата |
| payway | no | "anycash" | платежная система, через которую проводится выплата |

!!! success "Данные ответа метода" **count**размер текущей выборки ответов**data**массив \[репрезентаций ордеров\]\(add\_order.md\) типа \*\*payout\*\***first**номер первого ордера в выборке ответов метода**page**текущая страница ответов**page\_total**всего страниц ответов**total**всего найдено ордеров, соответствующих фильтрам запроса

??? failure "Возможные возвращаемые ошибки" **EParamCurrencyInvalid**не удалось найти валюту с переданным именем \*\*in\_curr\*\*, \*\*out\_curr\*\***EParamInvalid**передано неверное значение параметра**EParamPaywayInvalid**указана неверная платежная система**EParamType**параметр содержит некорректный тип данных

## history.convert

Метод отображения ордеров конвертаций валют \(типа **convert**\), отфильтрованных по названиям валют зачисления и/или пополнения. Фильтры поиска объединены логическим **И**. Если не будет задана ни одна из них, то метод вернет список операций конвертации мерчанта во всех валютах.  
Результат возвращается в виде отсортированного по убыванию даты создания перечня ордеров типа **convert**. Для каждого из них доступна репрезентация его параметров.

??? abstract "Входящие параметры метода"

| param | required | example | description |
| ---: | :---: | :--- | :--- |
| count | no | "199" | размер выборки ответов метода \(значение не может превышать "200"\). default="20" |
| first | no | "03" | номер объекта в полученной выборке результатов, с которого начнётся вывод списка ордеров конвертации и отсчета параметра **count**. default="0" |
| in\_curr | no | "UAH" | валюта пополнения в операции конвертации |
| out\_curr | no | "GBP" | валюта зачисления в операции конвертации |

!!! success "Данные ответа метода" **count**размер текущей выборки ответов**data**массив \[репрезентаций ордеров\]\(add\_order.md\) типа \*\*convert\*\***first**номер первого ордера, с которого начнется отсчет параметра \*\*count\*\*, в выборке ответов метода**page**текущая страница ответов**page\_total**всего страниц ответов**total**всего найдено ордеров, соответствующих фильтрам запроса

??? failure "Возможные возвращаемые ошибки" **EParamCurrencyInvalid**не удалось найти валюту с переданным именем \*\*in\_curr\*\*, \*\*out\_curr\*\***EParamInvalid**переданы неверные значения любого из параметров \*\*first\*\*, \*\*count\*\***EParamType**переданы данные неверного типа для любого из параметров \*\*first\*\*, \*\*count\*\*

## history.transfer

Метод отображения перечня ордеров перемещения средств, привязанных к данному мерчанту. Фильтры поиска объединены логическим **И**.  
Результат возвращается в виде отсортированного по убыванию даты создания перечня ордеров типа **transfer**. Для каждого из них доступна репрезентация его параметров.

??? abstract "Входящие параметры метода"

| param | required | example | description |
| ---: | :--- | :--- | :--- |
| count | no | "100" | размер выборки ответов метода \(значение не может превышать "200"\). default="20" |
| first | no | "13" | номер первого объекта в выборке результатов, с которого начнется их репрезентация и отсчёт параметра **count**. default="0" |
| in\_curr | no | "USD" | фильтр ордеров по названию валюты пополнения |
| out\_curr | no | "UAH" | фильтр ордеров по названию валюты зачисления |

!!! success "Данные ответа метода" **count**размер текущей выборки ответов**data**массив \[репрезентаций ордеров\]\(add\_order.md\) типа \*\*transfer\*\***first**номер первого ордера в выборке ответов метода**page**текущая страница ответов**page\_total**всего страниц ответов**total**всего найдено ордеров, соответствующих фильтрам

??? failure "Возможные возвращаемые ошибки" **EParamCurrencyInvalid**не удалось найти валюту с переданным именем \*\*in\_curr\*\*, \*\*out\_curr\*\***EParamInvalid**переданы неверные значения любого из параметров \*\*first\*\*, \*\*count\*\***EParamType**переданы данные неверного типа для любого из параметров \*\*first\*\*, \*\*count\*\*

## history.statement

Метод поиска и отображения движений средств по счетам мерчанта. Фильтры поиска объединяются логическим **И**.

??? abstract "Входящие параметры метода"

| param | required | example | description |
| ---: | :---: | :--- | :--- |
| begin | no | "123456789" | фильтр начала периода \(timestamp\). default="0" |
| count | no | "132" | максимальный размер выборки ответов \(значение не может превышать 200\). default="20" |
| curr | no | "UAH" | название валюты платежа |
| end | no | "234567890" | фильтр окончания периода \(timestamp\). default="now" |
| externalid | no | "127" | фильтр по параметру **externalid** ордера |
| filter\_amount | no | "&gt;123.4" | фильтр по сумме движения средств с операндом-условием. Возможные операнды: \(+, -, &lt;, &lt;=, &gt;, &gt;=, =, !=\). Если передано только число или число с операндом "+" или "-", то система использует логику "=". Операнды "+" или "-" могут передаваться без суммы, что будет означать только положительные или отрицательные значения соответственно |
| filter\_fee | no | "&gt;13.4" | комиссия за данное движение средств. В его валюте с операндом-условием. Возможные операнды: \(+, -, &lt;, &lt;=, &gt;, &gt;=, =, !=\). Если передано только число или число с операндом "+" или "-", то система использует логику "=". Операнды "+" или "-" могут передаваться без суммы, что будет означать только положительные или отрицательные значения соответственно |
| first | no | "32" | номер первого объекта в выборке ответов, с которого начнётся вывод набора движений средств и отсчёт параметра **count**. default="0" |
| group | no | "inpay" | фильтр по типу ордера \(возможные значения: "inpay", "outpay", **convert**, **transfer**\) |
| ord\_by | no | "amount" | сортировать объекты \("amount" - по сумме, "ctime" - по времени создания\) |
| ord\_dir | no | false | направление сортировки результатов, если передан **ord\_by**\(**false**=high-&gt;low, **true**=low-&gt;high\). default=**false** |

??? info "Особенности обработки пары параметров **begin**, **end**" Аргументу **begin** система **всегда** присвоит меньшее значение из переданной пары, а для **end** - всегда большее. Вне зависимости от того, под каким из имён они были переданы

!!! success "Данные ответа метода" Перечень параметров движения средств по счетам мерчанта в формате json массива **count**размер текущей выборки ответов**data**репрезентации найденых движений средств в формате json объекта**amount** - сумма изменения баланса мерчанта, указанная в движении средств по счетам**balance** - состояние баланса \*\*сразу после\*\* выполнения данного движения средств**ctime** - время \(timestamp\) создания движения средств по счетам мерчанта**curr** - валюта баланса**externalid** - внешний идентификатор ордера**fee** - сумма комиссии за операцию в валюте баланса**model** - общая модель, к которой относится платеж**oid** - идентификатор движения средств по счетам мерчанта**other\_curr** - валюта ордера, по которому сформировано движение средств по счетам мерчанта**payway** - имя платежного метода \(платежной системы\)**tp** - тип ордера, по которому сформировано движение средств по счетам мерчанта&lt;/dd&gt; **first** номер первого объекта в выборке ответов метода **page** текущая страница ответов **page\_total** всего страниц ответов **total** всего найдено объектов, соответствующих фильтрам запроса &lt;/dl&gt;

??? failure "Возможные возвращаемые ошибки" **EParamCurrencyInvalid**не удалось найти валюту с переданным именем \*\*curr\*\***EParamInvalid**передано неверное значение параметра**EParamType**параметр содержит некорректный тип данных**EStateCurrencyInactive**валюта с переданным именем \*\*curr\*\* не активна\(отключена\)

## history.address

Метод отображения перечня ордеров пополнений переданного криптоадреса и их параметров. Фильтры поиска объединены логическим **И**.

??? abstract "Входящие параметры метода"

| param | required | example | description |
| ---: | :---: | :--- | :--- |
| addr\_id | yes | "4356" | идентификатор криптоадреса |
| begin | no | "123456789" | фильтр начала периода \(timestamp\). default="0" |
| count | no | "99" | максимальный размер выборки ответов \(значение не может превышать 200\). default="20" |
| end | no | "234567890" | фильтр окончания периода \(timestamp\). default="now" |
| first | no | "5" | номер объекта в полученной выборке результатов, с которого начнётся вывод JSON Array адресов и отсчет параметра **count**. default="0" |
| out\_curr | no | "RUB" | фильтр по валюте зачисления для ордеров с автоконвертацией. В ответ метода попадут только ордера с автоконвертацией в переданную валюту |
| status | no | "done" | фильтр по текущему статусу ордера \(допустимые значения: "unfinished", "done", "fail"\) |
| tp | no | "autopayin" | фильтр ордеров по типу \(допустимые значения **payin**, **invoice** и **autopayin**\) |

!!! success "Данные ответа метода" Перечень ордеров в формате json массива **count**размер текущей выборки ответов**data**\[репрезентации\]\(add\_order.md\) найденых ордеров в формате json объекта**first**номер первого ордера в выборке ответов метода**page**текущая страница ответов**page\_total**всего страниц ответов**total**всего найдено ордеров, соответствующих фильтрам запроса

??? failure "Возможные возвращаемые ошибки" **EParamCurrencyInvalid**не удалось найти валюту с переданным именем \*\*out\_curr\*\***EParamInvalid**переданы неверные значения любого из параметров \*\*first\*\*, \*\*count\*\*, \*\*begin\*\*, \*\*end\*\*, \*\*tp\*\*, \*\*status\*\***EParamType**переданы данные неверного типа для любого из параметров \*\*addr\_id\*\*, \*\*is\_autoconvert\*\*, \*\*first\*\*, \*\*count\*\*, \*\*begin\*\*, \*\*end\*\*, \*\*status\*\***EStateCurrencyInactive**валюта с переданным именем \*\*out\_curr\*\* не активна\(отключена\)

